import{A as H,G as J,H as K,I as Q,K as U,b as k,c as D,d as M,e as N,f as j,q as F,x as L,y as z,z as G}from"./chunk-53SUOSEC.js";import{$a as u,Bb as O,Ca as o,Da as S,Gb as m,Hb as d,Ib as V,La as R,O as y,Xa as q,Za as c,bb as l,db as E,eb as I,fa as f,fb as _,g as T,ga as h,gb as s,hb as P,ib as w,jb as g,nb as b,ob as a,p as B,q as $,w as v,wb as A,xb as r,zb as x}from"./chunk-N7X6CS5K.js";import"./chunk-4CLCTAJ7.js";var X=(e,i)=>i.id;function Y(e,i){if(e&1&&(r(0),m(1,"titlecase")),e&2){let t=a(3);x(" ",d(1,1,t.queryParams.brewery_type)," ")}}function Z(e,i){e&1&&r(0," Near Me ")}function ee(e,i){if(e&1&&r(0),e&2){let t=a(3);x(" named ",t.queryParams.name," ")}}function te(e,i){e&1&&r(0," in ")}function ie(e,i){if(e&1&&(r(0),m(1,"titlecase")),e&2){let t=a(3);x(" ",d(1,1,t.queryParams.city),", ")}}function ne(e,i){if(e&1&&(r(0),m(1,"titlecase")),e&2){let t=a(3);x(" ",d(1,1,t.queryParams.state)," ")}}function oe(e,i){if(e&1){let t=g();_(0,"button",7),b("click",function(){f(t);let p=a(5);return h(p.previousPage())}),r(1,"\xAB Previous"),s()}}function ae(e,i){if(e&1){let t=g();_(0,"button",7),b("click",function(){f(t);let p=a(5);return h(p.nextPage())}),r(1,"Next \xBB"),s()}}function re(e,i){if(e&1&&(_(0,"div",4)(1,"div",5),c(2,oe,2,0,"button",6),m(3,"async"),s(),_(4,"div",5),r(5),m(6,"number"),m(7,"number"),m(8,"number"),s(),_(9,"div",5),c(10,ae,2,0,"button",6),m(11,"async"),s()()),e&2){let t=a(4);o(2),l(d(3,5,t.currentPage$)!==1?2:-1),o(3),O(" ",d(6,7,t.start)," - ",d(7,9,t.end)," of ",d(8,11,t.total)," breweries "),o(5),l(d(11,13,t.currentPage$)!==t.totalPages?10:-1)}}function le(e,i){e&1&&w(0)}function ce(e,i){if(e&1&&(_(0,"div",3),P(1,"brew-brewery",8),s()),e&2){let t=i.$implicit;o(),u("brewery",t)}}function _e(e,i){e&1&&w(0)}function se(e,i){if(e&1&&(c(0,re,12,15,"ng-template",null,0,V)(2,le,1,0,"ng-container",1),_(3,"div",2),E(4,ce,2,1,"div",3,X),s(),c(6,_e,1,0,"ng-container",1)),e&2){let t=A(1),n=a(2);o(2),u("ngTemplateOutlet",t),o(2),I(n),o(2),u("ngTemplateOutlet",t)}}function pe(e,i){e&1&&(_(0,"p"),r(1,"No breweries found."),s())}function me(e,i){if(e&1&&(_(0,"h1"),c(1,Y,2,3),r(2," Breweries "),c(3,Z,1,0)(4,ee,1,1)(5,te,1,0)(6,ie,2,3)(7,ne,2,3),s(),c(8,se,7,2)(9,pe,2,0,"p")),e&2){let t=a(),n=a();o(),l(n.queryParams.brewery_type?1:-1),o(2),l(n.queryParams.dist?3:-1),o(),l(n.queryParams.name?4:-1),o(),l(n.queryParams.city||n.queryParams.state?5:-1),o(),l(n.queryParams.city?6:-1),o(),l(n.queryParams.state?7:-1),o(),l(t.length>0?8:9)}}function de(e,i){if(e&1&&c(0,me,10,7),e&2){let t=a();l(t.loadingError?-1:0)}}function Ce(e,i){e&1&&P(0,"brew-loading",9)}function ue(e,i){if(e&1){let t=g();_(0,"p")(1,"clr-alert",10)(2,"clr-alert-item")(3,"span",11),r(4," There was an issue loading brewery data. Please try again. "),s(),_(5,"div",12)(6,"button",13),b("click",function(){f(t);let p=a(2);return h(p.getBreweries())}),r(7,"Retry"),s()()()()()}e&2&&(o(),u("clrAlertClosable",!1)("clrAlertType","danger"))}function xe(e,i){if(e&1&&c(0,Ce,1,0,"brew-loading",9)(1,ue,8,2,"p"),e&2){let t=a();l(t.loadingError?1:0)}}var W=class e extends U{constructor(t,n){super(t);this.route=n}currentPage$=new T(1);end;paginatedSearchResults$;perPage=50;searchResults$;start;total;totalPages;queryParams;ngOnInit(){super.ngOnInit(),this.getRouteParams(),this.searchResults$=this.breweriesSvc.searchResults$.pipe(v(t=>!!t),y(t=>this.total=t.length)),this.paginatedSearchResults$=$([this.searchResults$.pipe(v(t=>!!t)),this.currentPage$]).pipe(B(([t,n])=>{let p=(n-1)*this.perPage,C=p+this.perPage;return this.start=p+1,this.end=Math.min(C,this.total),this.totalPages=Math.ceil(this.total/this.perPage),t.slice(p,C)}))}getRouteParams(){let t=this.route.queryParams.pipe(y(n=>{this.queryParams=n,this.breweriesSvc.changeSearchCriteria(this.queryParams)})).subscribe();this.subscription.add(t)}nextPage(){this.currentPage$.next(this.currentPage$.getValue()+1)}previousPage(){this.currentPage$.getValue()>1&&this.currentPage$.next(this.currentPage$.getValue()-1)}static \u0275fac=function(n){return new(n||e)(S(J),S(F))};static \u0275cmp=R({type:e,selectors:[["brew-search"]],features:[q],decls:3,vars:3,consts:[["pagination",""],[4,"ngTemplateOutlet"],[1,"clr-row"],[1,"clr-col-sm-12","clr-col-md-6","clr-col-lg-4","clr-col-xl-3"],[1,"clr-row","clr-align-items-center","clr-justify-content-center",2,"margin-top","1.2rem"],[1,"clr-col-sm-12","clr-col-md-auto","text-center"],[1,"btn","btn-link","btn-sm"],[1,"btn","btn-link","btn-sm",3,"click"],[3,"brewery"],["text","Searching"],[3,"clrAlertClosable","clrAlertType"],[1,"alert-text"],[1,"alert-actions"],[1,"btn","btn-danger","btn-sm",2,"margin","0",3,"click"]],template:function(n,p){if(n&1&&(c(0,de,1,1),m(1,"async"),c(2,xe,2,1)),n&2){let C;l((C=d(1,1,p.paginatedSearchResults$))?0:2,C)}},dependencies:[K,H,L,z,G,j,k,D,N,M,Q],encapsulation:2})};export{W as SearchComponent};
